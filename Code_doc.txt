def list_all_folders(folder, level=0):
    print("  " * level + folder.Name)
    for f in folder.Folders:
        list_all_folders(f, level + 1)

outlook = win32.gencache.EnsureDispatch("Outlook.Application")
ns = outlook.Session
root = ns.GetDefaultFolder(6).Parent  # mailbox root
list_all_folders(root)
